################################################################################
# VIRTUALBOX & WSL MANAGEMENT
# Purpose: VirtualBox VM autostart, WSL configuration, Windows environment setup
# Used for: VirtualBox VM automation, Windows Subsystem for Linux setup
################################################################################

# ========== VIRTUALBOX VM AUTOSTART ==========
# List all VirtualBox VMs
VBoxManage list vms

# List VMs by UUID
VBoxManage list vms --long

# Enable autostart for specific VM (use exact name as shown in list)
VBoxManage modifyvm "exact_vm_name" --autostart-enabled on

# Set VM autostart delay (in seconds)
VBoxManage modifyvm "exact_vm_name" --autostop-type savestate

# Define global autostart database path
VBoxManage setproperty autostartdbpath /etc/vbox

# Enable VirtualBox autostart service
sudo systemctl enable vboxautostart-service

# Start VirtualBox autostart service
sudo systemctl start vboxautostart-service

# Check autostart service status
sudo systemctl status vboxautostart-service

# Disable autostart for VM
VBoxManage modifyvm "exact_vm_name" --autostart-enabled off

# ========== WSL (Windows Subsystem for Linux) ==========
# Install WSL 2
wsl --install

# Repair WSL binaries
wsl.exe /repair

# Check WSL binary integrity
Get-FileHash "C:\Windows\System32\wsl.exe" -Algorithm SHA256

# Install WSL via winget package manager
winget install --id Microsoft.WSL

# Install WSL with package agreements
winget install --id Microsoft.WSL --source winget --accept-package-agreements --accept-source-agreements

# Check winget package manager version
winget --version

# List available winget sources
winget source list

# Check WSL status
wsl --status

# List installed WSL distributions
wsl -l -v

# List WSL distros (verbose with versions)
wsl --list --verbose

# Install specific Ubuntu version
wsl --install -d Ubuntu-22.04

# Launch Ubuntu in WSL
wsl -d Ubuntu

# Run Windows system file integrity check
sfc /scannow

# ========== MONGODB INSTALLATION & CONFIGURATION ==========
# Add MongoDB GPG key for Ubuntu 22.04 (Jammy)
curl -fsSL https://pgp.mongodb.com/server-6.0.asc | sudo gpg -o /usr/share/keyrings/mongodb-server-6.0.gpg --dearmor

# Add MongoDB repository for Ubuntu 22.04
echo "deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-6.0.gpg ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/6.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list

# Update package list after adding MongoDB repo
sudo apt update

# Install MongoDB 6.0
sudo apt install -y mongodb-org

# Start MongoDB service
sudo systemctl start mongod

# Enable MongoDB autostart at boot
sudo systemctl enable mongod

# Check MongoDB status
systemctl status mongod

# ========== MONGODB SHELL (MONGOSH) ==========
# Connect to MongoDB on localhost (default port)
mongosh mongodb://localhost:27017

# Connect to MongoDB on specific IP and port
mongosh mongodb://192.168.0.3:27017

# Show all databases
show dbs

# Switch to specific database
use plane

# Show collections in database
show collections

# Query all documents in collection (pretty print)
db.tickets.find().pretty()

# Find specific document
db.tickets.findOne({_id: ObjectId("...")})

# Insert document
db.tickets.insertOne({name: "test", status: "open"})

# Update document
db.tickets.updateOne({_id: ObjectId("...")}, {$set: {status: "closed"}})

# Delete document
db.tickets.deleteOne({_id: ObjectId("...")})

# ========== DOCKER OPERATIONS ==========
# Check backend API health endpoint
curl http://localhost:8000/api/health

# Check tickets endpoint
curl http://localhost:8000/api/tickets

# Check specific ticket by ID
curl http://localhost:8000/api/tickets/12345

# Stop all Docker containers and services
docker compose down

# Stop containers and remove volumes
docker compose -f docker-compose.override.yml down -v

# Build and start Docker containers
docker compose -f docker-compose.override.yml up --build

# Create empty .env file to suppress warnings
touch /plane/.env

# ========== NODE.JS & NPM OPERATIONS ==========
# Build production React application
npm run build

# Install global npm package
npm install -g serve

# Run local static server with build directory
npx serve -s build -l 3000

# Access local React app
# Browser: http://localhost:3000
# Browser: http://192.168.0.3:3000

# Install project dependencies
npm install

# Start development server
npm start

# ========== SYSTEM INFORMATION COMMANDS ==========
# List all block devices and partitions
lsblk

# Get Linux distribution information
lsb_release -a

# Show kernel and system architecture
uname -a

# Check disk usage on root partition
df -h /

# Show operating system details
cat /etc/os-release

# List all PCI devices (includes NICs, GPUs, RAID controllers)
lspci -nn

# Show detailed network interface information
sudo lshw -class network

# List all network links and their status
ip link

# Show all network interfaces and IP addresses
ip a

# Display routing table and default gateway
ip r

# ========== NETPLAN NETWORK CONFIGURATION ==========
# List all Netplan configuration files
ls /etc/netplan

# View default network configuration (created during OS install)
sudo nano /etc/netplan/00-installer-config.yaml

# View cloud-init network configuration (used in cloud/VM environments)
sudo nano /etc/netplan/50-cloud-init.yaml

# View custom Netplan configuration
sudo nano /etc/netplan/01-netcfg.yaml

# Apply Netplan network configuration changes
sudo netplan apply

# Generate Netplan configuration (validate syntax)
sudo netplan generate

# ========== SSH SETUP ==========
# Update package list
sudo apt update

# Install OpenSSH server
sudo apt install openssh-server -y

# Enable SSH service at boot
sudo systemctl enable ssh

# Start SSH service
sudo systemctl start ssh

# Test SSH connection to remote host
ssh user@192.168.1.50

# ========== GNS3 SETUP & TROUBLESHOOTING ==========
# Check which GNS3 packages are installed
dpkg -l | grep gns3

# Try to check GNS3 server config (may fail if virtualenv needed)
gns3server --check-config

# Find gns3server binary in virtualenv
sudo find / -name gns3server 2>/dev/null

# Activate GNS3 server Python virtualenv
source /home/gns3/.venv/gns3server-venv/bin/activate

# Check GNS3 server version
gns3server --version

# Check GNS3 server configuration file
cat ~/.config/GNS3/2.2/gns3_server.conf

# View specific Qemu section of GNS3 config
cat ~/.config/GNS3/2.2/gns3_server.conf | grep -A2 '\[Qemu\]'

# Verify QEMU binary is installed
which qemu-system-x86_64

# Find GNS3 server configuration file
find /home/gns3/.config/GNS3 -name "gns3_server.conf" 2>/dev/null

# ========== FILE OPERATIONS ==========
# Copy directory with all contents
cp -r /home/user/folder1 /home/user/backup/

# Copy directory with verbose output
cp -rv /home/user/folder1 /home/user/backup/

# Copy only newer or missing files
cp -ru /home/user/folder1 /home/user/backup/

# Move directory
mv /source/directory /destination/directory

# ========== DIRECTORY NAVIGATION ==========
# Change to home directory
cd ~

# Change to parent directory
cd ..

# Change to root directory
cd /

# Navigate to Downloads
cd ~/Downloads

# Navigate to specific directory
cd /opt/gns3

# List directory contents
ls

# List directory contents (short format)
ls

# Attempt change to directory (case-sensitive note)
cd GNS3.VM.VirtualBox.2.2.54

# ========== DOCKER SYSTEMD SERVICE ==========
# Reload systemd daemon after service changes
sudo systemctl daemon-reload

# Restart Docker systemd service
sudo systemctl restart ticketing-docker

# Check Docker service status
sudo systemctl status ticketing-docker

# Enable Docker service autostart at boot
sudo systemctl enable ticketing-docker

# Stop Docker service
sudo systemctl stop ticketing-docker

# Start Docker service
sudo systemctl start ticketing-docker

# ========== BECOME ROOT USER ==========
# Switch to root user (need password)
sudo -i

# Or use sudo for single command
sudo command-name
