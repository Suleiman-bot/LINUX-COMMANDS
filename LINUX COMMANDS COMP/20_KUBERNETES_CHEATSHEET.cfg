################################################################################
# KUBERNETES CHEATSHEET
# Purpose: Common kubectl commands and quick debugging steps
# Used for: Pods, Deployments, Nodes, Networking and quick cluster fixes
################################################################################

# ========== POD ESSENTIALS ==========
# Show pods with IP and node
kubectl get pods -o wide

# Stream pod logs in real-time
kubectl logs -f <pod-name>

# Open an interactive shell inside a pod
kubectl exec -it <pod-name> -- sh

# Describe a pod (status + events)
kubectl describe pod <pod-name>

# Force-delete a pod immediately (no grace)
kubectl delete pod <pod-name> --grace-period=0 --force

# ========== NODE & CLUSTER ==========
# List all nodes and status
kubectl get nodes

# Show node CPU/Memory usage
kubectl top nodes

# Safely evict pods from a node for maintenance
kubectl drain <node-name>

# Mark a node unschedulable (cordon)
kubectl cordon <node-name>

# Show cluster info (API server, DNS)
kubectl cluster-info

# ========== DEPLOYMENT & SCALING ==========
# Create a deployment from an image
kubectl create deployment <name> --image=<image>

# Scale a deployment
kubectl scale deployment/<name> --replicas=3

# Restart a deployment (triggers rolling restart)
kubectl rollout restart deployment/<name>

# Roll back to previous revision
kubectl rollout undo deployment/<name>

# Watch rollout progress
kubectl rollout status deployment/<name>

# ========== NETWORKING ==========
# List services and external IPs
kubectl get svc

# Expose a deployment as a service
kubectl expose deployment <name> --port=80 --target-port=8080 --type=ClusterIP

# Port-forward a local port to a pod port
kubectl port-forward pod/<pod-name> 8080:80

# List ingress rules
kubectl get ingress

# List endpoints for a service
kubectl get endpoints <service-name>

# ========== DEBUGGING & FIXES ==========
# Edit live resource in your editor (applies on save)
kubectl edit <resource>/<name>

# Apply a manifest file (create or update)
kubectl apply -f <file.yaml>

# Diff local file vs live resource
kubectl diff -f <file.yaml>

# Check if a user/service-account can perform an action
kubectl auth can-i create pods --as system:serviceaccount:default:my-sa

# List available API resource types
kubectl api-resources

# ========== CLEANUP ==========
# Delete resources from a file
kubectl delete -f <file.yaml>

# Delete all pods in the current namespace
kubectl delete pod --all

# Remove failed eviction records
kubectl delete evictions --all

# Prune resources not present in manifests (be careful)
kubectl prune
